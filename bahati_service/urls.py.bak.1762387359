# bahati_service/urls.py
from django.contrib import admin
from django.urls import path, include, re_path
from django.views.generic import TemplateView, RedirectView   # ← add RedirectView
from django.http import HttpResponse
from scheduler import views as sviews  # ok to keep, but we won't use it for root


def healthz(_request):
    return HttpResponse("ok", content_type="text/plain")

urlpatterns = [
    path("admin/", admin.site.urls),
    path("healthz/", healthz),
    path("healthz", healthz),

    # HTML pages (namespace MUST be "scheduler")
    path("service/", include(("scheduler.urls_pages", "scheduler"), namespace="scheduler")),
    
    path("service/dashboard/", RedirectView.as_view(url="/service/driver_dashboard/", permanent=False)),

    


    # JSON API
    path("service/api/", include(("scheduler.api_urls", "scheduler_api"), namespace="scheduler_api")),

    # SPA mount
    path("driver/", TemplateView.as_view(template_name="driver/index.html")),
    re_path(r"^driver/.*$", TemplateView.as_view(template_name="driver/index.html")),

    # ROOT → redirect (instead of a view that can 404)
    path("", RedirectView.as_view(url="/service/", permanent=False), name="root_redirect"),
]

