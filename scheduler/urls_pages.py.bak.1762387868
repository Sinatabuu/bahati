from django.urls import path
from django.contrib.auth import views as auth_views
from . import views
from django.contrib.auth import views as auth_views  # <-- important: alias
from . import views as sviews                      
from django.contrib.auth.views import LogoutView
app_name = "scheduler"

urlpatterns = [
    # Auth (HTML screens)
    path("", sviews.home, name="home"),
    #path("", sviews.root, name="home"),
    path("login/",  sviews.user_login,  name="user_login"),
    path("logout/", auth_views.LogoutView.as_view(next_page="scheduler:user_login"), name="user_logout"),
    path(
        "logout/",
        LogoutView.as_view(next_page="/"),  # or next_page="/service/login/"
        name="user_logout",
    ),
    path("home/", sviews.home, name="home_index"),
# REMOVED: admin_client_defaults (missing view)
    path("schedule/today/", sviews.schedule_today_page, name="schedule_today_page"),
    path("api/client/<int:pk>/mini/", sviews.client_mini, name="client_mini"),
    path("api/clients/search/", sviews.clients_search, name="clients_search"),
    path("api/recommend/driver/", sviews.recommend_driver, name="recommend_driver"),
    path("api/schedule/reassign/",sviews.reassign_schedule_entry_v2,name="schedule_reassign_v2",),


    
    
    

    # Screens
    path("driver-dashboard/",   sviews.driver_dashboard,        name="driver_dashboard"),
    path("generate/",           sviews.generate_schedule_view,  name="generate"),
    path("schedule-list/",      sviews.schedule_list,           name="schedule_list"),
    path("daily_schedule/",     sviews.daily_schedule_sheet,    name="daily_schedule_sheet"),
    path("cancelled-schedules/",sviews.cancelled_schedule,      name="cancelled_schedule"),
    path("reassign_schedule/", sviews.reassign_schedule,     name="reassign_schedule"),
    path("driver/ping-location/",     sviews.driver_ping_location,    name="driver_ping_location"),
    # CRUD pages
    path("add_schedule/", sviews.add_schedule, name="add_schedule"),
    path("add_driver/",   sviews.add_driver,   name="add_driver"),
    path("add_client/",   sviews.add_client,   name="add_client"),
    path("client_list/",  sviews.client_list,  name="client_list"),
    path("driver_list/",  sviews.driver_list,  name="driver_list"),

    # Tools / reports (HTML)
    path("suspects/",                           sviews.suspects_report,       name="suspects_report"),
    path("entry/<int:entry_id>/swap/",          sviews.entry_swap_endpoints,  name="entry_swap_endpoints"),
    path("entry/<int:entry_id>/mark-reviewed/", sviews.entry_mark_reviewed,   name="entry_mark_reviewed"),
    path("tools/bulk-swap/",                    sviews.bulk_swap_coords,      name="bulk_swap_coords"),
    path("generate/schedule/", sviews.generate_schedule, name="generate_schedule"),
    path("api/schedule/status/", sviews.update_schedule_status_api, name="schedule_status_api"),

    # Dev/test HTML helpers
    path("dev/status-tester/",   sviews.dev_status_tester,   name="dev_status_tester"),
    path("dev/reassign-tester/", sviews.dev_reassign_tester, name="dev_reassign_tester"),
    path("dev/three-day/",       sviews.dev_three_day,       name="dev_three_day"),
    path("dev/schedule-viewer/", sviews.dev_schedule_viewer, name="dev_schedule_viewer"),

    # Misc page
    path("map-test/", sviews.map_test, name="map_test"),


    path("service/session-info/", sviews.session_info),
    path("service/set-session-probe/", sviews.set_session_probe),
    path("service/whoami/", sviews.whoami),
    path("service/driver-dashboard/", sviews.driver_dashboard, name="driver_dashboard"),
    
    path("csrf/", sviews.csrf_probe, name="csrf_probe"),
    path("schedule-entries/", sviews.schedule_entries_json, name="schedule_entries_json"),
    path("set-schedule-status/", sviews.set_schedule_status, name="set_schedule_status"),

  
    path("api/driver/<int:driver_id>/entries/", sviews.driver_entries_today, name="driver_entries_today"),
    path("api/entry/<int:entry_id>/cancel/", sviews.entry_cancel, name="entry_cancel"),
    path("api/entry/<int:entry_id>/reassign/", sviews.entry_reassign, name="entry_reassign"),
    path("api/schedule/", sviews.schedule_entries_json, name="api_schedule"),
    path("api/schedule/reassign/", sviews.reassign_schedule_entry_v2, name="schedule_reassign_v2"),
    path("api/schedule/cancel/", sviews.cancel_schedule_entry_v2, name="schedule_cancel_v2"),
]







